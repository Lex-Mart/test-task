{"version":3,"sources":["redux/types.js","redux/actions.js","components/CategoryLink.js","components/Header.js","routes/Categories.js","components/NewsItem.js","routes/News.js","routes/NewsDetails.js","App.js","redux/rootReducer.js","index.js"],"names":["ADD_CATEGORIES","ADD_NEWS","UPDATE_PAGE_INFO","ADD_DETAILS","getData","link","prop","a","axios","get","data","getNews","categoryId","dispatch","getState","state","currentPage","news","currentPages","nextPage","undefined","isLastPage","newsList","length","updatePageInfo","type","map","obj","pageInfo","CategoryLink","props","to","pathname","newsId","className","name","Header","title","Categories","useDispatch","categories","useSelector","useEffect","id","NewsItem","descr","str","date","Date","Intl","DateTimeFormat","weekday","hour","minute","second","day","month","year","format","dateFormatter","shortDescription","News","useParams","filter","scrollHandler","useCallback","e","target","documentElement","scrollHeight","scrollTop","window","innerHeight","throttle","document","addEventListener","removeEventListener","idx","NewsDetails","find","newsDetails","details","dangerouslySetInnerHTML","__html","fullDescription","App","exact","path","initNewsState","rootReducer","combineReducers","store","createStore","compose","applyMiddleware","thunk","__REDUX_DEVTOOLS_EXTENSION__","app","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.768c79fd.chunk.js","sourcesContent":["export const ADD_CATEGORIES = 'ADD_CATEGORIES'\r\nexport const ADD_NEWS = 'ADD_NEWS'\r\nexport const UPDATE_PAGE_INFO = 'UPDATE_PAGE_INFO'\r\nexport const ADD_DETAILS = 'ADD_DETAILS'","import { ADD_CATEGORIES, ADD_DETAILS, ADD_NEWS, UPDATE_PAGE_INFO } from './types'\r\nimport axios from 'axios'\r\n\r\nconst getData = async (link, prop) => (await axios.get(link)).data[prop]\r\n\r\nexport const getCategories = () => async (dispatch) => {\r\n    const categories = await getData('https://testtask.sebbia.com/v1/news/categories', 'list')\r\n    dispatch({\r\n        type: ADD_CATEGORIES,\r\n        categories,\r\n    })\r\n}\r\n\r\nexport const getNews = (categoryId) => async (dispatch, getState) => {\r\n    const state = getState()\r\n    let currentPage = state.news.currentPages[categoryId]?.currentPage\r\n    currentPage = currentPage === undefined ? -1 : currentPage\r\n    const nextPage = currentPage + 1\r\n    const isLastPage = state.news.currentPages[categoryId]?.isLastPage || false\r\n\r\n    if (!isLastPage) {\r\n        const link = `https://testtask.sebbia.com/v1/news/categories/${categoryId}/news?page=${nextPage}`\r\n        const newsList = await getData(link, 'list')\r\n\r\n        if (newsList.length) {\r\n            dispatch(updatePageInfo(nextPage, categoryId, !newsList.length))\r\n            dispatch({\r\n                type: ADD_NEWS,\r\n                news: newsList.map((obj) => ({ ...obj, categoryId })),\r\n            })\r\n        } else {\r\n            dispatch(updatePageInfo(currentPage, categoryId, !newsList.length))\r\n        }\r\n    }\r\n}\r\n\r\nexport const updatePageInfo = (currentPage, categoryId, isLastPage) => ({\r\n    type: UPDATE_PAGE_INFO,\r\n    pageInfo: {\r\n        currentPage,\r\n        categoryId,\r\n        isLastPage,\r\n    },\r\n})\r\n\r\nexport const getNewsDetails = (id) => async (dispatch) => {\r\n    const details = await getData(`https://testtask.sebbia.com/v1/news/details?id=${id}`, 'news')\r\n    dispatch({\r\n        type: ADD_DETAILS,\r\n        details,\r\n    })\r\n}\r\n","import React from 'react'\r\nimport {Link} from 'react-router-dom'\r\n\r\nconst CategoryLink = (props) => {\r\n    return(\r\n        <Link \r\n            to={{\r\n                pathname: `/${props.newsId}/news`, \r\n            }}\r\n            className=\"collection-item\"\r\n        >{props.name}</Link>\r\n    )\r\n}\r\n\r\nexport default CategoryLink","import React from 'react'\r\n\r\nconst Header = (props) => {\r\n    return(\r\n        <header>\r\n            <h1>{props.title}</h1>\r\n            <hr/>\r\n        </header>\r\n    )\r\n}\r\n\r\nexport default Header","import React, {useEffect} from 'react'\r\nimport {useDispatch, useSelector} from 'react-redux'\r\nimport {getCategories} from '../redux/actions'\r\nimport CategoryLink from '../components/CategoryLink'\r\nimport Header from '../components/Header'\r\n\r\nconst Categories = () => {\r\n    const dispatch = useDispatch()\r\n    const categories = useSelector(state => state.categories)\r\n\r\n    useEffect(() => {\r\n        if(!categories.length) dispatch(getCategories())\r\n    }, [categories.length, dispatch])\r\n\r\n    return(\r\n    <>\r\n        <Header title='Список категорий'/>\r\n        <div className=\"collection\">\r\n            {categories.map(({name, id}) => \r\n                <CategoryLink\r\n                    key={id}\r\n                    name={name}\r\n                    newsId={id}\r\n                />\r\n            )}\r\n        </div>\r\n    </>)\r\n}\r\n\r\nexport default Categories","import React from 'react'\r\nimport { Link } from 'react-router-dom'\r\n\r\nconst NewsItem = (props) => {\r\n    const dateFormatter = str => {\r\n        const date = new Date(str)\r\n        const formatter = Intl.DateTimeFormat('ru', {\r\n            weekday: 'long',\r\n            hour: 'numeric',\r\n            minute: 'numeric',\r\n            second: 'numeric',\r\n            day: 'numeric',\r\n            month: 'numeric',\r\n            year: 'numeric',\r\n        })\r\n        return formatter.format(date)\r\n    }\r\n\r\n    return(\r\n        <div className=\"card darken-1\">\r\n            <div className=\"card-content black-text\">\r\n                <Link to={{\r\n                    pathname: `/details/${props.descr.id}`,\r\n                }}>\r\n                    <span className=\"card-title blue-text\">{props.descr.title}</span>\r\n                </Link>\r\n                <span className=\"grey-text\">{dateFormatter(props.descr.date)}</span>\r\n                <hr/>\r\n                <p>{props.descr.shortDescription}</p>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default NewsItem","import React, {useCallback, useEffect} from 'react'\r\nimport {useParams} from 'react-router-dom'\r\nimport Header from '../components/Header'\r\nimport NewsItem from '../components/NewsItem'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { getNews } from '../redux/actions'\r\nimport throttle from 'lodash/throttle'\r\n\r\nconst News = () => {\r\n    const categoryId = useParams().id\r\n    const dispatch = useDispatch()\r\n    const newsList = useSelector(state => state.news.newsList.filter(obj => obj.categoryId === categoryId))\r\n    \r\n    let scrollHandler = useCallback((e) => {\r\n        if(e.target.documentElement.scrollHeight - (e.target.documentElement.scrollTop + window.innerHeight) < 200) {\r\n            dispatch(getNews(categoryId))\r\n        }\r\n\r\n    }, [categoryId, dispatch]) \r\n\r\n    scrollHandler = throttle(scrollHandler, 250)\r\n \r\n    useEffect(() => {\r\n        document.addEventListener('scroll', scrollHandler)\r\n        return () => document.removeEventListener('scroll', scrollHandler)\r\n    }, [scrollHandler])\r\n\r\n    useEffect(() => {\r\n        if(!newsList.length) dispatch(getNews(categoryId))     \r\n    }, [categoryId, dispatch, newsList.length])\r\n \r\n    return(\r\n        <>\r\n            <Header title=\"Новости\"/>\r\n            {newsList.map((news, idx) => <NewsItem key={idx} descr={news}/>)}\r\n        </>\r\n    )\r\n}\r\n\r\nexport default News","import React, { useEffect } from 'react'\r\nimport {useParams} from 'react-router-dom'\r\nimport Header from '../components/Header'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { getNewsDetails } from '../redux/actions'\r\n\r\nconst NewsDetails = () => {\r\n    const dispatch = useDispatch()\r\n    const newsId = useParams().id\r\n    const news = useSelector(state => state.news.newsList.find(obj => obj.id === +newsId))\r\n    const newsDetails = useSelector(state => state.newsDetails.find(obj => obj.id === +newsId))\r\n\r\n    useEffect(() => {\r\n        if(!newsDetails) dispatch(getNewsDetails(newsId))\r\n    }, [dispatch, newsDetails, newsId])\r\n\r\n    return(\r\n        <div>\r\n            <Header title={news?.title || newsDetails?.title}/>\r\n            <span className=\"grey-text\">{news?.shortDescription || newsDetails?.shortDescription}</span>\r\n            <p className=\"flow-text\" dangerouslySetInnerHTML={{__html: newsDetails?.fullDescription}}></p>\r\n            {undefined}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default NewsDetails","import React from 'react'\r\nimport {BrowserRouter as Router, Switch, Route} from 'react-router-dom'\r\nimport Categories from './routes/Categories'\r\nimport News from './routes/News'\r\nimport NewsDetails from './routes/NewsDetails'\r\n\r\nconst App = () => {\r\n    return(\r\n        <div className='container'>\r\n            <Router>\r\n                <Switch>\r\n                    <Route exact path='/'>\r\n                        <Categories/>\r\n                    </Route>\r\n                    <Route path='/:id/news'>\r\n                        <News/>\r\n                    </Route>\r\n                    <Route path='/details/:id'>\r\n                        <NewsDetails/>\r\n                    </Route>\r\n                </Switch>\r\n            </Router>\r\n        </div>\r\n    )    \r\n}\r\n\r\nexport default App","import { combineReducers } from \"redux\";\r\nimport { ADD_CATEGORIES, ADD_DETAILS, ADD_NEWS, UPDATE_PAGE_INFO} from \"./types\";\r\n\r\nconst initNewsState = {\r\n    newsList: [],\r\n    currentPages: {},\r\n}\r\n\r\nconst categories = (state = [], {type, categories}) => {\r\n    switch(type) {\r\n        case ADD_CATEGORIES:\r\n            return [...categories]\r\n        default: return state\r\n    }\r\n}\r\n\r\nconst news = (state = initNewsState, {type, news, pageInfo}) => {\r\n    switch(type) {\r\n        case ADD_NEWS:\r\n            return {\r\n                ...state,\r\n                newsList: [\r\n                    ...state.newsList,\r\n                    ...news\r\n                ]\r\n            }\r\n        case UPDATE_PAGE_INFO:\r\n            return {\r\n                ...state,\r\n                currentPages: {\r\n                    ...state.currentPages,\r\n                    [pageInfo.categoryId]: {...pageInfo}\r\n                }\r\n            }\r\n        default: return state\r\n    }\r\n}\r\n\r\nconst newsDetails = (state = [], {type, details}) => {\r\n    switch(type) {\r\n        case ADD_DETAILS:\r\n            return [\r\n                ...state,\r\n                {...details}\r\n            ]\r\n    default: return state\r\n    }\r\n}\r\n\r\n\r\nexport const rootReducer = combineReducers({\r\n    categories,\r\n    news,\r\n    newsDetails\r\n})","import React from 'react';\nimport {render} from 'react-dom';\nimport { applyMiddleware, compose, createStore } from 'redux';\nimport {Provider} from 'react-redux'\nimport thunk from 'redux-thunk'\nimport './index.css';\nimport App from './App';\nimport { rootReducer } from './redux/rootReducer';\n\nconst store = createStore(rootReducer, compose(\n  applyMiddleware(thunk),\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\n))\n\nconst app = (\n  <Provider store={store}>\n    <App/>\n  </Provider>\n)\n\nrender(\n  <React.StrictMode>\n    {app}\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}